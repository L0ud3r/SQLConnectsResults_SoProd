(function(n){function i(n){return n.length==1&&n[0]===""}function r(n,t,i){return i.indexOf(n)===t}function t(n,t){var r=[],f=[],i,u;if(n)for(i=0;i<n.length;i++)r[n[i]]=!0;if(t)for(i=0;i<t.length;i++)r[t[i]]&&delete r[t[i]];for(u in r)r.hasOwnProperty(u)&&f.push(u);return f}function u(t){return t==undefined?[]:t&&!Array.isArray(t)?t.id&&t.element&&n(t.element).hasClass("checked")?[t.id]:[]:undefined}function f(n,t){for(var i=0,r=t.length;i<r;i=i+1)if(equal(n,t[i]))return i;return-1}n.fn.extend({select2MultiCheckboxes:function(){var e=n.extend({placeholder:"Choose elements",formatSelection:function(n,t){return n.length+" > "+t+" total"},wrapClass:"wrap"},arguments[0]);this.each(function(){var o=n(this).select2({msOptions:e,allowClear:!0,minimumResultsForSearch:0,matcher:function(n,t,i){return t.toUpperCase().indexOf(n.toUpperCase())>=0||i.parent("optgroup").attr("label").toUpperCase().indexOf(n.toUpperCase())>=0},placeholder:e.placeholder,closeOnSelect:!1,formatSelection:function(){var o=this.element.data("select2"),u=n("option",this.element),s=u.length-1,t=o.data(),f,i,e;return t=t&&t.length?t.filter(n=>n):t,f=u.filter((i,r)=>t&&t.length>0&&t.indexOf(n(r).attr("value"))>-1),i=[],n(f).each(function(){var t=n(this).closest("optGroup").find("option").length,r=n(this).closest("optGroup").find("option.checked").length;t==r?i.push("<b>"+n(this).closest("optGroup").attr("label")+"<\/b>"):i.push(n(this).text())}),i=i.filter(r),e=i.map(n=>({text:n})),this.msOptions.formatSelection(e,s)},formatResult:function(t){var f=this.element.data("select2"),u=[this.msOptions.wrapClass],i,r;return n(t.element[0]).hasClass("checked")&&u.push("checked"),i=n("<div>").text(t.text).addClass(u.join(" ")),t.element[0].localName=="optgroup"&&(n(t.element).children().length==n(t.element).children(".checked").length&&(n(t.element).addClass("checked"),n(i).addClass("checked")),n(i).click(function(){n(t.element).hasClass("checked")?(n(t.element).removeClass("checked"),n(t.element).find("option").removeClass("checked"),n(t.element).find("option").prop("selected",!1),n(this).parent().parent().find(".wrap").removeClass("checked")):(n(t.element).addClass("checked"),n(t.element).find("option").addClass("checked"),n(t.element).find("option").prop("selected",!0),n(this).parent().parent().find(".wrap").addClass("checked"));f.onSelect()})),t.element[0].localName=="option"&&(r=n(t.element).parent(),r&&r.length&&r[0].localName==="optgroup"&&n(i).click(function(){!n(t.element).hasClass("checked")&&n(t.element).parent().hasClass("checked")&&(n(t.element).parent().removeClass("checked"),n(this).closest(".select2-result-with-children").find("> .select2-result-label .wrap").removeClass("checked"));n(t.element).hasClass("checked")&&!n(t.element).parent().hasClass("checked")&&n(t.element).parent().children().length==n(t.element).parent().children(".checked").length&&(n(t.element).parent().addClass("checked"),n(this).closest(".select2-result-with-children").find("> .select2-result-label .wrap").addClass("checked"))})),i}}).data("select2");o.onSelect=function(i,r){var u,e,i,o,f;i&&r&&(n(i.element[0]).toggleClass("checked"),u=n(r.target),u.hasClass(this.opts.msOptions.wrapClass)||(u=n("."+this.opts.msOptions.wrapClass,u)),u.toggleClass("checked"));e=this.selection.data("select2-data");i=[];n(".checked",this.select).each(function(){i.push(n(this).val())});o=t(e?e:[],i?i:[]);f=this.selection.find(".select2-chosen");f.empty();i.length>0?(this.selection.data("select2-data",i),this.triggerChange({added:i,removed:o}),f.append(this.opts.formatSelection()),this.selection.removeClass("select2-default")):(i=null,this.selection.data("select2-data",i),this.triggerChange({added:i,removed:o}),f.append(this.getPlaceholder()),this.selection.addClass("select2-default"));return};o.updateSelection=function(t){var r=[],u=[],i=this;n(t).each(function(){f(i.id(this),r)<0&&(r.push(i.id(this)),u.push(this))});t=u;this.selection.find(".select2-search-choice").remove();i.postprocessResults();return};o.data=function(t){return function(i){var f,r,e;if(arguments.length==1)f={},n(i).each(function(){f[this.id]=!0}),this.select.find("option").each(function(){var t=n(this);t[f[t.val()]===!0?"addClass":"removeClass"]("checked")});else return r=this.selection.data("select2-data"),e=u(r),e!==undefined&&(r=e),r&&r.length&&this.opts.allowClear&&!this.container.hasClass("select2-allowclear")?this.container.addClass("select2-allowclear"):r&&r.length||this.container.removeClass("select2-allowclear"),this.selection.data("select2-data",r),r;return t.apply(this,arguments)}}(o.data);o.val=function(){return function(r){var f,u,e,o,s;return arguments.length===0?(f=[],u=this.data(),u=u&&u.length?u.filter(n=>n):u,n(u).each(function(){f.push(this.toString())}),f):(e=this.selection.data("select2-data"),(r===""||r==undefined||i(r))&&(r=[]),r=Array.isArray(r)?r.map(n=>typeof myVar=="string"?n:n+""):(r+"").split(","),this.selection.data("select2-data",r),this.selection.removeClass("select2-default"),o=t(e?e:[],r),this.triggerChange({added:r,removed:o}),s=this.selection.find(".select2-chosen"),s.empty().append(this.opts.formatSelection()),n(this.select))}}(o.val);o.select.on({change:function(t){var i,r=this.nodeName=="SELECT"?this:this.select?this.select:this;if(t.removed)for(i=0;i<t.removed.length;i++)n('option[value="'+t.removed[i]+'"]',r).removeClass("checked"),n('option[value="'+t.removed[i]+'"]',r).prop("selected",!1);if(t.added)for(i=0;i<t.added.length;i++)n('option[value="'+t.added[i]+'"]',r).addClass("checked"),n('option[value="'+t.added[i]+'"]',r).prop("selected",!0)}})})}})})(jQuery);